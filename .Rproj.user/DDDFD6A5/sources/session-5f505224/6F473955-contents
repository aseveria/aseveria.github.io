---
title: "Comp/Stat 112: Tidy Tuesday 13"
author: "Alicia Severiano"
output:
  bookdown::html_document2:
    split_by: none
    toc: yes
    toc_depth: 3
    toc_float:
      toc_collapsed: true
    number_sections: false
---

```{r data_setup}
# Get the Data
library(tidyverse)

wcmatches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/wcmatches.csv')
worldcups <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv')

```

## Data Context

### World Cup

The data this week comes from [FIFA World Cup](https://www.kaggle.com/datasets/evangower/fifa-world-cup).

> As we count down to the start of the FIFA World Cup in Qatar on November 20, this new dataset covers every single World Cup match played in its history from Uruguay in 1930 to Russia in 2018.

> The wcmatches dataset contains every football match played in the World Cup. Columns inside the dataset include city from which city was the match being played in, outcome which team claimed victory or did the match result in a draw, win_condition showing if the winning side need added extra time of penalties to win the game.

> It also includes a summary of each World Cup held, the cups dataset contains columns winners, games, goals_scored, and more.

Some data explorations: <https://www.kaggle.com/datasets/evangower/fifa-world-cup/code>


More details including the codebook is available [here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-11-29)


```{r}
head(wcmatches)
head(worldcups)
```


## Research Question

Develop a research question that you are interested in. *You may need to play with the data a little bit to learn more about what the values mean before you decide on a question.*

> Do the Home teams typically win more than the Away Teams?

## Data Visualization

Create a visualization that answers or addresses your research question.

```{r}
wc<-wcmatches %>%
  filter(outcome %in% c("H", "A")) %>%
   group_by(year,outcome)  %>%
  summarize(Total = n()) 
  
  
library(plotly)
p <-wc %>%
  ggplot(aes(x=year, y= Total , color=outcome)) +
  geom_point() +
  geom_line() +
  scale_color_manual(values=c("steelblue2" ,  "saddlebrown")) +
  annotate("text", x= 1992,, y=24, label="Home", color="saddlebrown") +
  annotate("text" , x = 2004,,y=16,label="Away" , color="steelblue2") +
  labs(x=NULL, y=NULL) +
  ggtitle("<span style='font-size: 18pt;'>FIFA World Cup Matches 1930-2019 \n<span style='font-size: 12pt;'>Total Couth of Wins Per Team Type & Year") +
theme_classic() +
    theme(legend.position= "none") 
ggplotly(p)

  

 
```
